<mujoco model="dragon">
  <compiler coordinate="local" convexhull="false" angle="radian" />
  <option timestep="0.005" gravity="0 0 -9.81" collision="all"/>
  <option density="1" viscosity="1e-3" collision="all"/>
  <!-- <size njmax="500" nconmax="100" /> -->

    <asset>
        <mesh name="ducted_fan_head_link" file="ducted_fan_head_link.stl" />
        <mesh name="ducted_fan_gimbal_roll" file="ducted_fan_gimbal_roll.stl" />
        <mesh name="ducted_fan_gimbal_pitch" file="ducted_fan_gimbal_pitch.stl" />
        <mesh name="inter_joint_junction" file="inter_joint_junction.stl" />
        <mesh name="ducted_fan_baselink" file="ducted_fan_baselink.stl" />
        <mesh name="ducted_fan_general_link" file="ducted_fan_general_link.stl" />
        <mesh name="ducted_fan_end_link" file="ducted_fan_end_link.stl" />
    </asset>

    <worldbody>
      <geom name="floor" pos="0 0 0" size="2 2 .2" type="plane"  conaffinity="1" rgba="1 1 1 1" condim="3"/>
      <body name="dragon_base" pos="0 0 0.5">
        <geom pos="0.212 0 0" type="mesh" contype="1" conaffinity="0" group="1" mesh="ducted_fan_head_link" />
        <joint name="root" type="free" />
        <body name="gimbal1_roll_module" pos="0.212 0 0">
            <inertial pos="-0.0276 0.00042 0.01548" quat="0.938888 0 0.344224 0" mass="0.4604" diaginertia="0.000366667 0.000366667 0.000366667" />
            <joint name="gimbal1_roll" pos="0 0 0" axis="1 0 0" limited="true" range="-3.14 3.14" damping="0.1" />
            <geom pos="-0.01 0 0" type="mesh" contype="1" conaffinity="0" group="1" mesh="ducted_fan_gimbal_roll" />
            <body name="gimbal1_pitch_module" pos="0 0 0.037">
                <inertial pos="0 0.000329988 -0.00870967" quat="0.5 0.5 -0.5 0.5" mass="0.53012" diaginertia="0.00610425 0.00610225 0.000102002" />
                <joint name="gimbal1_pitch" pos="0 0 0" axis="0 1 0" limited="true" range="-3.14 3.14" damping="0.1" />
                <geom type="mesh" contype="1" conaffinity="0" group="1" mesh="ducted_fan_gimbal_pitch" />
                <body name="thrust1" pos="0 0 0">
                    <inertial pos="0 0 0" quat="0.5 0.5 -0.5 0.5" mass="0.0001" diaginertia="2e-05 1e-05 1e-05" />
                    <!-- <joint name="rotor1" pos="0 0 0" axis="0 0 1" limited="true" range="2 30" /> -->
                    <site name="rotor1" pos="0 0 0" />
                </body>
            </body>
        </body>
        <body name="inter_joint1" pos="0.424 0 0">
            <inertial pos="0.02918 -0.00427 -0.00155" mass="0.1329" diaginertia="0.0001 0.0001 0.0001" />
            <joint name="joint1_pitch" pos="0 0 0" axis="0 1 0" limited="true" range="-1.5708 1.5708" damping="0.9" frictionloss="0.05" />
            <geom pos="0.02575 0 0" type="mesh" contype="1" conaffinity="0" group="1" mesh="inter_joint_junction" />
            <body name="link2" pos="0.0515 0 0">
                <inertial pos="0.221541 -0.00473999 -0.0156795" quat="0.460842 0.514367 0.469753 0.549894" mass="1.13481" diaginertia="0.0228564 0.0219029 0.00174496" />
                <joint name="joint1_yaw" pos="0 0 0" axis="0 0 1" limited="true" range="-1.5708 1.5708" damping="0.9" frictionloss="0.05" />
                <geom pos="0.212 0 0" type="mesh" contype="1" conaffinity="0" group="1" mesh="ducted_fan_baselink" />
                <body name="gimbal2_roll_module" pos="0.212 0 0">
                    <inertial pos="-0.0276 0.00042 0.01548" quat="0.938888 0 0.344224 0" mass="0.4604" diaginertia="0.000366667 0.000366667 0.000366667" />
                    <joint name="gimbal2_roll" pos="0 0 0" axis="1 0 0" limited="true" range="-3.14 3.14" damping="0.1" />
                    <geom pos="-0.01 0 0" type="mesh" contype="1" conaffinity="0" group="1" mesh="ducted_fan_gimbal_roll" />
                    <body name="gimbal2_pitch_module" pos="0 0 0.037">
                        <inertial pos="0 0.000329988 -0.00870967" quat="0.5 0.5 -0.5 0.5" mass="0.53012" diaginertia="0.00610425 0.00610225 0.000102002" />
                        <joint name="gimbal2_pitch" pos="0 0 0" axis="0 1 0" limited="true" range="-3.14 3.14" damping="0.1" />
                        <geom type="mesh" contype="1" conaffinity="0" group="1" mesh="ducted_fan_gimbal_pitch" />
                        <body name="thrust2" pos="0 0 0">
                            <inertial pos="0 0 0" quat="0.5 0.5 -0.5 0.5" mass="0.0001" diaginertia="2e-05 1e-05 1e-05" />
                            <!-- <joint name="rotor2" pos="0 0 0" axis="0 0 1" limited="true" range="2 30" /> -->
                            <site name="rotor2" pos="0 0 0" />
                        </body>
                    </body>
                </body>
                <body name="inter_joint2" pos="0.424 0 0">
                    <inertial pos="0.02918 -0.00427 -0.00155" mass="0.1329" diaginertia="0.0001 0.0001 0.0001" />
                    <joint name="joint2_pitch" pos="0 0 0" axis="0 1 0" limited="true" range="-1.5708 1.5708" damping="0.9" frictionloss="0.05" />
                    <geom pos="0.02575 0 0" type="mesh" contype="1" conaffinity="0" group="1" mesh="inter_joint_junction" />
                    <body name="link3" pos="0.0515 0 0">
                        <inertial pos="0.19922 -0.0058 -0.01695" quat="0.461488 0.514859 0.48185 0.538302" mass="0.9289" diaginertia="0.0198464 0.018889 0.00146457" />
                        <joint name="joint2_yaw" pos="0 0 0" axis="0 0 1" limited="true" range="-1.5708 1.5708" damping="0.9" frictionloss="0.05" />
                        <geom pos="0.212 0 0" type="mesh" contype="1" conaffinity="0" group="1" mesh="ducted_fan_general_link" />
                        <body name="gimbal3_roll_module" pos="0.212 0 0">
                            <inertial pos="-0.0276 0.00042 0.01548" quat="0.938888 0 0.344224 0" mass="0.4604" diaginertia="0.000366667 0.000366667 0.000366667" />
                            <joint name="gimbal3_roll" pos="0 0 0" axis="1 0 0" limited="true" range="-3.14 3.14" damping="0.1" />
                            <geom pos="-0.01 0 0" type="mesh" contype="1" conaffinity="0" group="1" mesh="ducted_fan_gimbal_roll" />
                            <body name="gimbal3_pitch_module" pos="0 0 0.037">
                                <inertial pos="0 0.000329988 -0.00870967" quat="0.5 0.5 -0.5 0.5" mass="0.53012" diaginertia="0.00610425 0.00610225 0.000102002" />
                                <joint name="gimbal3_pitch" pos="0 0 0" axis="0 1 0" limited="true" range="-3.14 3.14" damping="0.1" />
                                <geom type="mesh" contype="1" conaffinity="0" group="1" mesh="ducted_fan_gimbal_pitch" />
                                <body name="thrust3" pos="0 0 0">
                                    <inertial pos="0 0 0" quat="0.5 0.5 -0.5 0.5" mass="0.0001" diaginertia="2e-05 1e-05 1e-05" />
                                    <!-- <joint name="rotor3" pos="0 0 0" axis="0 0 1" limited="true" range="2 30" /> -->
                                    <site name="rotor3" pos="0 0 0" />
                                </body>
                            </body>
                        </body>
                        <body name="inter_joint3" pos="0.424 0 0">
                            <inertial pos="0.02918 -0.00427 -0.00155" mass="0.1329" diaginertia="0.0001 0.0001 0.0001" />
                            <joint name="joint3_pitch" pos="0 0 0" axis="0 1 0" limited="true" range="-1.5708 1.5708" damping="0.9" frictionloss="0.05" />
                            <geom pos="0.02575 0 0" type="mesh" contype="1" conaffinity="0" group="1" mesh="inter_joint_junction" />
                            <body name="link4" pos="0.0515 0 0">
                                <inertial pos="0.16774 -0.00011 -0.02072" quat="0.49382 0.506105 0.506105 0.49382" mass="0.7943" diaginertia="0.0145 0.0134074 0.00119263" />
                                <joint name="joint3_yaw" pos="0 0 0" axis="0 0 1" limited="true" range="-1.5708 1.5708" damping="0.9" frictionloss="0.05" />
                                <geom pos="0.212 0 0" type="mesh" contype="1" conaffinity="0" group="1" mesh="ducted_fan_end_link" />
                                <body name="gimbal4_roll_module" pos="0.212 0 0">
                                    <inertial pos="-0.0276 0.00042 0.01548" quat="0.938888 0 0.344224 0" mass="0.4604" diaginertia="0.000366667 0.000366667 0.000366667" />
                                    <joint name="gimbal4_roll" pos="0 0 0" axis="1 0 0" limited="true" range="-3.14 3.14" damping="0.1" />
                                    <geom pos="-0.01 0 0" type="mesh" contype="1" conaffinity="0" group="1" mesh="ducted_fan_gimbal_roll" />
                                    <body name="gimbal4_pitch_module" pos="0 0 0.037">
                                        <inertial pos="0 0.000329988 -0.00870967" quat="0.5 0.5 -0.5 0.5" mass="0.53012" diaginertia="0.00610425 0.00610225 0.000102002" />
                                        <joint name="gimbal4_pitch" pos="0 0 0" axis="0 1 0" limited="true" range="-3.14 3.14" damping="0.1" />
                                        <geom type="mesh" contype="1" conaffinity="0" group="1" mesh="ducted_fan_gimbal_pitch" />
                                        <body name="thrust4" pos="0 0 0">
                                            <inertial pos="0 0 0" quat="0.5 0.5 -0.5 0.5" mass="0.0001" diaginertia="2e-05 1e-05 1e-05" />
                                            <!-- <joint name="rotor4" pos="0 0 0" axis="0 0 1" limited="true" range="2 30" /> -->
                                            <site name="rotor4" pos="0 0 0" />
                                        </body>
                                    </body>
                                </body>
                            </body>
                        </body>
                      </body>
                    </body>
                  </body>
                </body>
              </body>
      </worldbody>

      <actuator>
        <position name="joint1_pitch_servo" kp="40" joint="joint1_pitch" />
        <position name="joint1_yaw_servo"  kp="40" joint="joint1_yaw" />
        <position name="joint2_pitch_servo" kp="40" joint="joint2_pitch" />
        <position name="joint2_yaw_servo"  kp="40" joint="joint2_yaw" />
        <position name="joint3_pitch_servo" kp="40" joint="joint3_pitch" />
        <position name="joint3_yaw_servo"  kp="40" joint="joint3_yaw" />

        <position name="gimbal1_pitch_servo" kp="40" joint="gimbal1_pitch" />
        <position name="gimbal1_roll_servo"  kp="40" joint="gimbal1_roll" />
        <position name="gimbal2_pitch_servo" kp="40" joint="gimbal2_pitch" />
        <position name="gimbal2_roll_servo"  kp="40" joint="gimbal2_roll" />
        <position name="gimbal3_pitch_servo" kp="40" joint="gimbal3_pitch" />
        <position name="gimbal3_roll_servo"  kp="40" joint="gimbal3_roll" />
        <position name="gimbal4_pitch_servo" kp="40" joint="gimbal4_pitch" />
        <position name="gimbal4_roll_servo"  kp="40" joint="gimbal4_roll" />

        <motor name="rotor1_thrust" ctrllimited="true" ctrlrange="0.0 30.0" gear="0 0 1 0 0 -0.01" site="rotor1" />
        <motor name="rotor2_thrust" ctrllimited="true" ctrlrange="0.0 30.0" gear="0 0 1 0 0 -0.01" site="rotor2" />
        <motor name="rotor3_thrust" ctrllimited="true" ctrlrange="0.0 30.0" gear="0 0 1 0 0 -0.01" site="rotor3" />
        <motor name="rotor4_thrust" ctrllimited="true" ctrlrange="0.0 30.0" gear="0 0 1 0 0 -0.01" site="rotor4" />
      </actuator>
</mujoco>

