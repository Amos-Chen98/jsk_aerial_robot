<?xml version="1.0"?>
<launch>

  <arg name="simulation" default="false" />
  <arg name="imu_board" default="1" />  <!-- 1: d imu board, 0: kduino board -->
  <arg name="use_mocap" default="0" />
  <arg name="use_joy" default="0" />
  <arg name="use_opti" default="0" />
  <arg name="use_alt" default="0" />

  <arg name="imu_port" default="/dev/ttyUSB0" />
  <arg name="alt_port" default="/dev/ttyUSB1" />

  ################################# imu ########################################
  <group unless="$(arg simulation)">
    <include file="$(find spinal_ros_bridge)/launch/serial.launch" if="$(arg imu_board)">
      <arg name="baud" value="921600" />
      <arg name="port" value="$(arg imu_port)" />
    </include>

    <node pkg="rosserial_python" type="serial_node.py" name="serial_node" output="screen" unless="$(arg imu_board)">
      <param name="baud" value="115200" />
      <param name="port" value="$(arg imu_port)" />
    </node>

  </group>

  <rosparam file="$(find aerial_robot_base)/config/sensor_plugin/d_imu.yaml" command="load" if="$(arg imu_board)"/>
  <rosparam file="$(find aerial_robot_base)/config/sensor_plugin/kduino.yaml" command="load" unless="$(arg imu_board)"/>


  ############################### GPS #########################################
  <rosparam file="$(find aerial_robot_base)/config/sensor_plugin/gps.yaml" command="load" />

  ################################ mocap ##########################################
  <group if="$(arg use_mocap)">
    <include file="$(find aerial_robot_base)/launch/sensors/mocap.launch" unless="$(arg simulation)"/>
  </group>
  <rosparam file="$(find aerial_robot_base)/config/sensor_plugin/mocap.yaml" command="load" />

  ################################ altitude ######################################
  <group if="$(arg use_alt)">
    <include file="$(find aerial_robot_base)/launch/sensors/leddar_one.launch" unless="$(arg simulation)">
      <arg name="port" value="$(arg alt_port)" />
    </include>
  </group>
  <rosparam file="$(find aerial_robot_base)/config/sensor_plugin/leddar_one.yaml" command="load" />


  ################################# optical flow ###################################
  <group if="$(arg use_opti)">
    <include file="$(find aerial_robot_base)/launch/sensors/px4flow.launch" unless="$(arg simulation)"/>
  </group>
  <rosparam file="$(find aerial_robot_base)/config/sensor_plugin/optical_flow.yaml" command="load" />

  ################################# Joy Stick ######################################
  <group if="$(arg use_joy)">
    <include file="$(find aerial_robot_base)/launch/sensors/joy_stick.launch"  unless="$(arg simulation)"/>
  </group>

</launch>
